<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.triple.mapper.PointMapper">
	
	<!-- 포인트 데이터 생성 -->
	<insert id="createPointData" parameterType="pointDto">
		insert into point(
			 userId, activityType, activityId, pointScore, pointType
		) values (
			#{userId}, #{activityType}, #{activityId}, #{pointScore}, #{pointType}
		)
	</insert>
	
	<!-- 전체 사용자 포인트 조회 -->
	<select id="getAllUserPoint" resultType="pointDto">
		select userId, sum(pointScore) 
		from point
		group by userId
		order by userId
	</select>
	
	<!-- 전체 사용자 포인트 내역 조회 -->
	<select id="getAllPointRecords" resultType="pointDto">
		select pointId, userId, activityType, activityId, pointScore,  pointType, createdDate
		from point
		order by userId asc, createdDate desc
	</select>
	
	<!-- 특정 사용자 포인트 조회 -->
	<select id="getUserPoint" parameterType="String" resultType="pointDto">
		select userId, sum(pointScore) 
		from point
		where userId = #{userid}
	</select>
	
	<!-- 특정 사용자 포인트 내역 조회 -->
	<select id="getUserPointRecords" parameterType="String" resultType="pointDto">
		select pointId, userId, activityType, activityId, pointScore, pointType, createdDate
		from point
		where userId = #{userid}
		order by createdDate desc
	</select>
	
	<!-- 특정 활동과 관련된 사용자 포인트 내역 조회 -->
	<select id="getUserPointRecordsOfSpecificActivity"  parameterType="String" resultType="pointDto">
		select pointId, userId, activityType, activityId, pointScore, pointType, createdDate
		from point
		where userId = #{userid} and activityId = #{activityid}
		order by createdDate desc
	</select>
	
</mapper>